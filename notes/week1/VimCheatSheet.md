# Vim 常用操作速查表（Cheat Sheet）

> 注：以下命令均在 **普通模式 (Normal)** 下输入；`{n}` 表示数字次数；`{motion}` 表示移动命令；`{textobj}` 表示文本对象。

---

## 0) 模式切换
- `i / I`：插入（在光标处 / 行首）
- `a / A`：追加（在光标后 / 行尾）
- `o / O`：在下 / 上方新建一行并进入插入
- `Esc`：回到普通模式
- `v / V / Ctrl-v`：进入可视模式（字符 / 行 / 块）
- `:`：命令行模式
- `R`：替换模式

---

## 1) 光标移动 (Motions)
- 基本：`h` 左，`j` 下，`k` 上，`l` 右
- 行内：`0` 行首；`^` 首个非空；`$` 行尾
- 单词：`w/W` 到下个词首；`e/E` 到词尾；`b/B` 到上个词首
- 段落：`{` 上一段；`}` 下一段
- 行跳转：`gg` 文件首；`G` 文件尾；`{n}G` 到第 n 行；`:{n}` 也可
- 屏幕：`H` 顶；`M` 中；`L` 底；`Ctrl-u` 上半屏；`Ctrl-d` 下半屏
- 查找字符：`f{char}` 向右找；`F{char}` 向左找；`;`/`,` 重复
- 括号匹配：`%` 在配对括号间跳转
- 路径打开：`gf` 打开光标下文件

---

## 2) 选择 (Visual)
- `v / V / Ctrl-v`：字符/行/块选择
- 在可视模式中：
  - 缩进：`>` / `<`（`>>` / `<<` 为行内快速缩进/反缩进）
  - 大小写：`u` 小写；`U` 大写；`~` 反转
  - 排序示例：`:'<,'>sort`（对选择范围排序）

---

## 3) 操作符 (Operators) + 移动 (Motions)
- 组合公式：`{n}{operator}{motion}`
- 删除：`d{motion}`（例：`dw`、`d$`、`diw`）
- 复制：`y{motion}`（例：`yy`，`y4j`，`y$`）
- 改写：`c{motion}`（改写=删除并进入插入，例：`ciw`、`c$`）
- 变换大小写：`g~{motion}` / `gu{motion}` / `gU{motion}`
- 连接行：`J`（把下一行接到本行行尾）

---

## 4) 文本对象 (Text Objects)
- 单词：`iw`（内词）、`aw`（含边界）
- 括号：`i(`/`a(`，`i{`/`a{`，`i[`/`a[`，`i<`/`a<`
- 引号：`i'`/`a'`，`i"`/`a"`，`i\``/`a\``
- 例：`diw` 删除所在“词”；`ci"` 改写引号内内容

---

## 5) 插入与编辑
- 插/改：`i`、`a`、`o`、`O`、`c{motion}`、`C`(到行尾)
- 删除：`x` 删字符；`X` 向左删；`dd` 删行；`D` 删到行尾
- 复制粘贴：`yy` 复制行；`p` 光标后粘贴；`P` 光标前粘贴
- 多行复制示例：
  - `5yy`：复制当前行起 5 行
  - `y4j`：复制当前行至下 4 行（共 5 行）
  - `:.,+4y`：复制当前行到下 4 行
- 重复上次操作：`.`

---

## 6) 撤销与重做
- `u` 撤销；`Ctrl-r` 重做
- `U` 撤销本行最后一次修改（某些配置下等同 `u`）

---

## 7) 搜索与替换
- 向下/向上搜索：`/pattern`、`?pattern`
- 结果导航：`n` 下一个；`N` 上一个
- 快速词搜索：`*` 搜索光标下词（向下）；`#`（向上）
- 替换命令：
  - 当前行：`:s/old/new/g`
  - 全文：`:%s/old/new/g`
  - 全文确认：`:%s/old/new/gc`
  - 选区：`:'<,'>s/old/new/g`
- 大小写敏感控制：`:set ignorecase smartcase`

---

## 8) 行与缩进
- 行操作：`==` 对当前行重新缩进；`={motion}` 对范围缩进
- 缩进：`>>` 右缩进；`<<` 左缩进
- 对齐例：`:'<,'>center 80`（将选区居中到 80 列）

---

## 9) 文件、保存、退出
- 保存/退出：`:w` 保存；`:q` 退出；`:wq` / `:x` 保存并退；`:q!` 强退
- 另存为：`:w newname`
- 读入/写出到外部命令：`:%!command`（过滤器）
- 使用 sudo 保存（只读文件）：`:w !sudo tee %`（有权限时生效）

---

## 10) 缓冲区 (Buffers)、窗口 (Windows)、标签页 (Tabs)
- 缓冲区：
  - `:ls` 列表；`:b {n|name}` 跳转；`:b#` 回到上个；`:bd` 关闭
- 窗口分屏：
  - 横分：`:sp`；竖分：`:vsp`
  - 光标移动：`Ctrl-w h/j/k/l`
  - 调整大小：`Ctrl-w +`/`-` 行高；`Ctrl-w >`/`<` 宽度
  - 关闭：`Ctrl-w c`（关窗）；`Ctrl-w q`（关窗/退）
- 标签页：
  - 新建：`:tabnew`；下一/上一：`gt` / `gT`；关闭：`:tabclose`

---

## 11) 标记 (Marks) 与跳转
- 设标记：`m{a-z}`（文件内）；`m{A-Z}`（跨文件）
- 跳转到标记处：`'{mark}` 到行首；`` `{mark} `` 到精确列
- 上次位置：`` `` ``（跳回刚才位置）；`''`（行级）

---

## 12) 寄存器 (Registers) 与剪贴板
- 查看寄存器：`:registers`
- 使用寄存器：`"{reg}y`、`"{reg}p`
- 系统剪贴板（若编译支持）：
  - `"+y` 复制到系统剪贴板；`"+p` 从系统剪贴板粘贴
  - 另：`"*` 为选择缓冲区（X11）

---

## 13) 宏 (Macros)
- 录制：`q{a-z}` 开始录到寄存器；`q` 结束
- 播放：`@{a-z}`；重复上次宏：`@@`
- 次数播放：`{n}@a`

---

## 14) 折叠 (Folds)（若启用）
- 打开/关闭：`zo` / `zc`
- 切换：`za`
- 全开/全关：`zR` / `zM`

---

## 15) 常用冒号范围 (Ranges)
- 当前行：`.`
- 相对行：`+{n}` / `-{n}`
- 全文：`%`
- 选择：`'<,'>`
- 示例：
  - `:1,10s/foo/bar/g` 替换 1–10 行
  - `:.,$y` 复制从当前行到文件末尾

---

## 16) 实用杂项
- 行号：`:set number`；相对行号：`:set relativenumber`
- 显示不可见字符：`:set list`
- 自动换行显示：`:set wrap` / `:set nowrap`
- 增量搜索：`:set incsearch`
- 临时显示空白错误：`:set list listchars=tab:>-,trail:·`
- 帮助：`:help {keyword}`（如 `:help ciw`）；在命令上按 `K` 查联机帮助

---

## 17) 典型操作示例
- **复制当前行起 5 行**：`5yy` 或 `:.,+4y`
- **删除引号内内容**：`di"`；**改写引号内**：`ci"`
- **把下一行并到本行**：`J`
- **搜索当前词并逐个确认替换**：`*` → `:%s//new/gc`
- **块选择给列对齐添加注释**：`Ctrl-v` 选列 → `I// ` → `Esc`

---

> 小贴士：Vim 命令可叠加次数，如 `3dw` 连删 3 个单词；`10j` 向下 10 行；`2@a` 执行寄存器 a 的宏两次。练习时多用 `.` 重复上一步操作，效率飞起。

